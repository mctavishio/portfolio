<!DOCTYPE html>
<html lang="en">
<head>
	<title>planets</title>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
	<meta name="description" content="the planets" />
	<meta name="author" content="kathy mctavish">
	<!-- from ::: http://www.favicon-generator.org/ -->
	<link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="../android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
	<link rel="manifest" href="../manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	<!-- JSON-LD : Google -->
	<script type="application/ld+json">
		{
			"@context": "http://schema.org",
			"@type": "WebPage",
			"name": "the planets",
			"breadcrumb": "mctavish.io > blue atlas > the planets",
          		"url": "https://www.mctavish.io/blueatlas/planets.html",
			"description": "blueatlas ::: the planets",
			"datePublished": "2021-02-03",
          		"image": "https://www.mctavish.io/mctavishIcon-01-04-01-01-01.png",
			"author": "https://mctavish.io/bio.html",
			"license": "http://creativecommons.org/licenses/by-nc-sa/3.0/us/deed.en_US"
		}
	</script>
	<link rel="stylesheet" href="../css/fieldnotes.css"/>
	<style>
		ul.stanza {
			margin-bottom: 1em;
		}
		main ul.stanza li {
			font-weight: bold;
		}
		main article:nth-child(odd) a:before {
			color: #fcfbe3;
			color: var(--warmwhite);
			content: ": ";
		}
		main article:nth-child(even) a:before {
			color: #000000;
			color: var(--warmblack);
			content: ": ";
		}
		a {
			text-decoration: none;
		}
		main article:nth-child(odd) a:after {
			color: #000000;
			color: var(--warmblack);
			content: " :";
		}
		main article:nth-child(even) a:after {
			color: #fcfbe3;
			color: var(--warmwhite);
			content: " :";
		}
		main {
			max-width: 600px;
		}
	</style>
</head>
<body id="top" >
<div id="subtextframe" class="frame zlowest"></div>
<div id="svgframe" class="frame zlow"><svg xmlns="http://www.w3.org/2000/svg" id="svg" class="frame"></svg></div>
<div id="wordframe" class="frame z0"></div>
<div id="contentframe" class="absolute zhighest">
<div id="mainflex">
<main id="main" class="expand" data-state="expanded">	
<header>
	<h1>the planets</h1>
	<h2>(- gravity -)</h2>
</header>
<!-- <ul data-role="narrator" class="info compress">
	<li class="title typewriter" title="telegraph" id="telegraph"></li>
	<li class="title  typewriter" title="clock" id="clock">here | now</li>
</ul> -->
<ul data-role="narrator" class="info expand">
	<li><a href="#" id="soundlink" class="corelink">turn on sound</a></li>
	<li><a href="index.html" id="homelink" class="corelink">return home</a></li>
</ul>
<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
	<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
	<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
	<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
	<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
	<article class="poem" >
	<header>
	<h1><a href="#top">^</a></h1>
	</header>
	<div class="textContent">
		<ul data-role="rider" class="stanza">
			<li>. </li>
			<li>. . .</li>
			<li>. . . .</li>
			<li>. . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . . . .</li>
			<li>. . . . . .</li>
			<li>. . . . .</li>
			<li>. . . .</li>
			<li>. . .</li>
			<li>.</li>
		</ul>
	</div>
</article>
<audio loop=true id="audio1" src="https://storage.googleapis.com/www.blueboatfilms.com/sound/benthowlpodcast.mp3" type="audio/mpeg">Your browser does not support the audio tag.</audio>
</main>
</div>
</div>
</body>
<script src="../code/velocity.min.js"></script>
<script src="../code/kefir201911.min.js"></script>
<!-- <script src="code/atlasabsence.js"></script> -->
<script>
let width = window.innerWidth, height = window.innerHeight;
let min = Math.min(width, height), max = Math.max(width, height);
let version = (min < 680 || max < 980) ? "small" : "large";
let v = version === "small" ? 0 : 1;
let z = {};
z.tools = {
	randominteger: (min, max) => {
		return Math.floor( min + Math.random()*(max-min));
	},
	logmsg: function(msg) {
		try { 
			console.log("### ::: " + msg); 
		}
		catch(err) { z.tools.logerror(err) }
	},
	logerror: function(error) {
		try { console.log("rusty error ... " + error); }
		catch(err) {}
	},
	randomhighharmonic: () => {
		let multipliers = [10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ];
	},
	randomharmonic: () => {
		let multipliers = [5, 7.5, 10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ];
	},
	randomlowharmonic: () => {
		let multipliers = [5, 7.5, 10.0, 12.5, 13.33, 15, 20];
		return multipliers[ z.tools.randominteger( 0, multipliers.length) ]/2;
	},
	randomkey: (object) => {
		let keys = Object.keys(object);
		let key = keys[z.tools.randominteger(0,keys.length)];
		// z.tools.logmsg("key = " + key);
		return key;
	},
	datestr: (date, options) => {
		if(options===undefined) options = {year: "numeric", month: "2-digit", day: "numeric", hour12: true, hour: "2-digit", minute: "2-digit", second: "2-digit"};
		return date.toLocaleTimeString("en-US", options);
		//new Date().toLocaleTimeString("en-US", {year: "numeric", month: "2-digit", day: "numeric", hour12: true, hour: "2-digit", minute: "2-digit", second: "2-digit"});
	},
	togrid: (min=1, max=1, x=1, ndivisions=1) => {
		let dx = Math.floor( (max-min) / ndivisions );
		return Math.floor( ( x-min+dx/2)/dx )*dx + min;
	},
};
//core elements
z.elements = ( () => {
	return {
		body: { el: document.querySelector("body") },
		main: { el: document.querySelector("main") },
		// clock: { el: document.querySelector("#clock") },
		// telegraph: { el: document.querySelector("#telegraph") },
		svg:  { el: document.querySelector("#svg") },
		frames: ["subtextframe", "svgframe", "wordframe", "contentframe"].reduce( (acc, id) => {
			z.tools.logmsg("create frame element ::: " + id);
			acc[id] = { el: document.querySelector("#"+id) };
			return acc;
		}, {}),
	}
})()
	
z.streams = {
	clock: ( () => {
	let dt = 1;
	let date0 = new Date();
	let t0 = Math.floor(date0.getTime()/1000);
	let state0 = { dt: dt, count: 0, date: date0, t: t0, t0: t0 };
	return Kefir.withInterval( dt*1000, emitter => { emitter.emit( { date: new Date() } ) })
			.scan( (state, e) => { 
				state.date = e.date;
				state.t = Math.floor(e.date.getTime()/1000);
				state.count = state.count + 1;
				return state;
			}, state0  )
	})( ),
	dimensions: ( () => {
		let dt = .4;
		const ngrids=[2,2], npasts=[0,0];
		let state0 = { dt: dt, count: 0,
			grid: { nrows: ngrids[v], ncols: ngrids[v], dx: Math.floor(width/ngrids[v]), dy: Math.floor(height/ngrids[v]), sw: 12, pastn: npasts[v] },
			width: width, height: height, 
			max: max, min: min, 
		};
		return Kefir.fromEvents(window, "resize").throttle(dt*1000)
			.scan( (state,e) => {
				state.width = window.innerWidth;
				state.height = window.innerHeight;
				state.max = Math.max(state.width, state.height);
				state.min = Math.min(state.width, state.height);
				state.grid.dx = Math.floor(state.width/state.grid.ncols);
				state.grid.dy = Math.floor(state.height/state.grid.nrows);
				state.grid.sw = Math.floor(Math.max(state.grid.dx*.03, state.grid.dy*.03, 4));
				return state
			}, state0) 
	})( ),
};

z.draw = z => {
	let ntimings = 32;
	let dtiming = Math.floor(400/ntimings);
	const timings = [...Array(ntimings).keys()].reduce( (acc, j) => {
		let duration = 500+(j*dtiming);
		acc[j] = [duration, 900-duration];
	return acc;
	}, []);
	// const timings = [ [380,600], [400,580], [480,500], [500,480], [580,400], [600,380], [640,340], [680,300], [700,280], [740,240], [780,200], [800,180], [840,140], [880,100]];
	// const timings = [ [180,800], [200,780], [280,700], [300,680], [380,600], [400,580], [480,500], [500,480], [580,400], [600,380], [640,340], [680,300], [700,280], [740,240], [780,200], [800,180], [840,140], [880,100]];
	// z.streams["clock"].onValue( e => {
	// 	z.elements["clock"].el.innerHTML = z.tools.datestr(new Date(e.t*1000));
	// });

	//controls
	( () => { 
		const soundlink = document.querySelector("#soundlink");
		const telegraph = document.querySelector("#telegraph");
		const audio1 = document.querySelector("#audio1");
		const baseurl = "https://storage.googleapis.com/www.blueboatfilms.com/sound/";
		const tracks = [
			{title: "bent / hOwl", url: "benthowlpodcast.mp3", duration:3240}, //54:00
			// {title: "graffiti / tunnel", url: "graffititunnelpodcast.mp3", duration:2710}, //45:12

		];
		let currenttrack = 0;
		let soundplaying = false;
		let track = tracks[0];
		audio1.src = baseurl + track.url;
		Kefir.fromEvents(soundlink, "click").onValue( e => {
			z.tools.logmsg("play sound !");
			if(!soundplaying) { 
				try {
					// currenttrack = (currenttrack+1)%tracks.length;
					// let track = tracks[currenttrack];
					// audio1.src = baseurl + track.url;
					// let starttime = z.tools.randominteger(0,track.duration);
					// let starttime = 0;
					// audio1.currentTime = starttime;
					audio1.play();
					z.tools.logmsg("playback resumed");
					telegraph.innerHTML =  "<i>(currently playing ::: " + track.title + ")</i>";
					soundplaying = true;
					soundlink.innerText = "turn off sound";
					soundlink.classList.add("active");
				} catch(e) { z.tools.logerror("dashboard ::: resumeaudio " + e) } 
			}
			else { 
				try {
					document.querySelector("#audio1").pause();
					telegraph.innerHTML =  " . . . >";
					soundplaying = false;
					soundlink.innerText = "turn on sound";
					soundlink.classList.remove("active");
				} catch(e) { z.tools.logerror("dashboard ::: suspendaudio " + e) }
			}
		});
	})();

	const playlist = [
		//primary colors
		["#fcfbe3", "#191918"], //"warmbw",
		//ny
		["#786652", "#5B4031", "#1A1E1C", "#B6B7B5", "#9B999C", "#16190D", "#5F3D35", "#71391E"], //nystairs
		["#FBFBFD", "#7B7879", "#575758", "#5D5048", "#7F7066", "#3C3C3C"], //nystairs
		["#977A6D", "#5B5350", "#87847D", "#57646F", "#AFBBC2", "#B6ADA8", "#1B3B51", "#2D2E31", "#546877"], //nystairs (blues)
		["#873E04", "#463730", "#7D838A", "#CE8430", "#732F02", "#4E4340", "#453732", "#A19F9B", "#5B4F44"], //nylibrary browns grays
		["#403B37", "#444242", "#444242", "#2F2824", "#423D3B", "#423D3B", "#8B5D3E", "#3F3E3F", "#2A211A", "#D8D8D8", "#6C727D"], //nylibrary browns grays blues
		["#644C39", "#5B4536", "#B69D88", "#614C3E", "#16100C", "#150F0B", "#120D07"], //ny art haring? all browns dark
		["#662512", "#865E40", "#B9916F", "#B58562", "#965C3D", "#662512", "#53200A", "#432916", "#955C3D", "#4A3321"], //ny art reds browns clay
		["#040302", "#75604F", "#CDBBAB", "#77614A", "#0E0A06", "#BEA794", "#603102", "#93520D", "#A99588", "#A97D51"], //ny art reds browns clay
		["#C09A7A", "#C68425", "#9C1704", "#B38968", "#0D0604", "#967051", "#941102", "#A64A25"], //nyart yellow orange red (vivid color)
		["#A4886E", "#866648", "#5F3B1A", "#452B14", "#79552C", "#896338", "#0D0903", "#AA9179", "#4F3015"], //nyart browns
		["#AE7C41", "#A54B18", "#AC6C35", "#90350F", "#75270D", "#633E1A", "#0A0502", "#A3270C"], //nyart browns red harring
		//city
		["#46474A", "#6C665F", "#6C6C6C", "#2C2D25", "#8D9194", "#2C2920", "#57524E", "#5C5D58"], //window mpls warehouse (green gray brown beige)
		["#848482", "#BEAA81", "#88816F", "#9D9892", "#463D2C", "#7F745E", "#30251A", "#3F3626", "#A09C93"], //mpls warehouse window (some yellow)
		["#AFBDD0", "#D7DCE1", "#93A7B8", "#4D585B", "#585151", "#908985", "#848181", "#4D585"], //tiger dancing (blues gray)
		["#D0D0D0", "#FBFBFB", "#999B99", "#91867F", "#5B4939", "#47392B", "#3C5D5C", "#535351", "#586463", "#304142", "#33261D", "#745C4B"], //bridge bgs (bg brown white0)
		["#4B2D13", "#081B30", "#194874", "#0B1C2C", "#0B1C2C", "#101721", "#305F83"], //canada night image w/brown blue dark too vivid?
		["#172F4F", "#2A68A1", "#2B4E6B", "#103354", "#3C6FA4"], //canada night image ll blue dark combine with above?
		["#EFF0F2", "#DAD1C5", "#828075", "#353934", "#0F1214", "#091007", "#47493D", "#393E2F", "#484E42", "#2D372E"], //greens mist railway duluth with white
		//birdland
		["#163341", "#172F47", "#4477A8", "#2A4A69", "#52779B", "#000000", "#384B60", "#1F3350", "#153A69", "#153559", "#9D9990", "#9D9990", "#181E21", "#0C1D32", "#706959", "#D6D3CE", "#534E48", "#3E5766", "#222E34", "#BBB4A4", "#7C7D7F"], //birdland

	];
	z.streams["color"] = ( dt => {
		let date0 = new Date();
		let t0 = Math.floor(date0.getTime()/1000);
		let state0 = { 
			dt: dt, count: 0,
			choices: playlist[ Math.floor(t0/dt)%playlist.length ]
		};
		return z.streams["clock"].filter( e => e.t%dt===0 )
			.scan( (state, e) => { 
				state.choices = playlist[ Math.floor(e.t/dt)%playlist.length ];
				// state.choices = playlist[ Math.floor(state.count)%playlist.length ];
				state.count = state.count + 1;
				return state;
			}, state0  )
	})( 38 );
	
	z.streams["draw"] = Kefir.combine([z.streams["clock"]], [z.streams["dimensions"], z.streams["color"]], (clock, dimensions, color) => { return {clock:clock, dimensions:dimensions, color:color} })
		.scan( (state, e) => { 
			state.clock = e.clock;
			state.dimensions = e.dimensions;
			state.color = e.color;
			state.count = state.count + 1;
			z.tools.logmsg("color.choices = " + e.color.choices);
			return state;
	}, {clock:{t:0}, dt:1}  );

//box
( dt => {
	const element = document.createElementNS("http://www.w3.org/2000/svg", "rect");
	element.setAttributeNS(null, "id", "box");
	element.setAttributeNS(null, "class", "shape square");
	z.elements["svg"].el.appendChild(element);
		
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		try {
			let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
			Velocity({	
				elements: element, 
				properties: { fillOpacity: 1.0, strokeOpacity: 0.0, fill: color, width: e.dimensions.width, height: e.dimensions.height },
				options: { duration: 2000,  delay: 0, easing: "easeInOutQuad" },
			});
		} catch(err) { z.tools.logerror("box animation ::: " + err ) }
	})
})(5);

//main
( dt => {
	const element = document.querySelector("main");
	const bgcolors = ["rgba(25, 25, 24, 0.4)", "rgba(25, 25, 24, 0.6)", "rgba(25, 25, 24, 0.9)", "rgba(252, 251, 227, 0.4)", "rgba(252, 251, 227, 0.9)", , "rgba(252, 251, 227, 0.6)"]
	// const warmblacktints = ["#191918", "#2f2f2f", "#464646", "#5e5e5d", "#757574", "#8c8c8b", "#a3a3a2", "#babab9", "#d1d1d0", "#e8e8e7", "#ffffff", "#fcfbe3", "#e2e1cc", "#c9c8b5", "#b0af9e", "#979688", "#7e7d71", "#64645a", "#4b4b44", "#32322d", "#191916", "#000000"];
	const warmblacktints = ["#191918", "#fcfbe3", "#000000"];

	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		try {
			let count = e.clock.t/dt;
			let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
			// z.tools.logmsg("in BOX " + color + " color =  " + color);
			Velocity({	
				elements: element, 
				properties: { backgroundColor:  color, backgroundColorAlpha: z.tools.randominteger(0.1,6)/10},
				options: { duration: 1200,  delay: 0, easing: "easeInOutQuad" },
			});
		} catch(err) { z.tools.logerror("box animation ::: " + err ) }
	})
})(9);

//words
( dt => {
	const nwords = [[0,1],[0,1]][v];
	const words = [
	// "_.._._+ . < +=_.._._+ . < +=_.._._+ . < +=: :  . < > '. . . . . .& | { . . ::: x",
	// "it was like this every morning", ".. - / .-- .- ... / .-.. .. -.- . / - .... .. ... / . ...- . .-. -.-- / -- --- .-. -. .. -. --.", //it was like this every morning
	// "aXQgd2FzIGxpa2UgdGhpcyBldmVyeSBtb3JuaW5n", //it was like this every morning
	// "01101000 01100101 01101100 01101100 01101111 00100000 01110111 01101111 01110010 01101100 01100100", //hello world
	// "aGVsbG8gd29ybGQ=", //hello world
	// "i0i000i0000iiii0i000i0000iii", //i
	// "_.._._+ . < +=_.._._+ . < +=_.._._+ . < +=: :  . < > '",". . . . . .& | { . . ::: x",
	// "#thecount ‰ 0 1 2 3 4 5 6 7 8 9 iº #aftercount #aftertime", //
	// "høly h0L¥ hølY H0ly ® Å Ö x x x ø 0 Ø x X x ø 0 Ø xº3",
	// "ø 0 ¥ ø Y H L ® Å Ö x x x ø 0 Ø x X x ø 0 Ø xº3",
	// "forEach Å øn t0uch Ž",
	".. - / .-- .- ... / .-.. .. -.- . / - .... .. ... / . ...- . .-. -.-- / -- --- .-. -. .. -. --.",
	// ":::::::::::::::::;+ ` #@@' `. @ :# +@@@@@' '@@@@@@@@' :@@@@@@@#@##' ,@@@@@@@##@+#++' :#@@@@@#@##+#'++'' +@ ;@@@@@##+''+'+''' '@@@@ @@@#@++'''+''';' ;@@@@@@@ +@##+'+';;';+;;' ,#@@@@#@@@# #+#++''';'';';;",
	];
	//do this for all words ...fit to screen size
	words.push([...Array([18,38][v]).keys()].reduce( (acc, key, j) => {
		acc[j] = ". . .. . :";
		return acc;
	}, []));
	const elements = nwords.reduce( (acc, id, j) => {
		z.tools.logmsg("create word element ::: " + id);
		let el = document.createElement("div");
		el.setAttribute("id", "word_" + id);
		el.setAttribute("class", "absolute monospace_zerodot");
		el.innerHTML = words[j%words.length];
		z.elements["frames"]["wordframe"].el.appendChild(el);
		el.style[ "opacity" ] = 0.0;
		el.style[ "whiteSpace" ] = "nowrap";
		acc[id] = { el: el };
		return acc;
	}, []);
	let n = elements.length;
	const drawings = [
		e => {
			try {
				let count = e.clock.t/dt;
				let element = elements[count%n];
				let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
				// elements.forEach( (element, j) => {
				element.el.innerText = words[count%words.length];
				element.el.style[ "fontSize" ] = e.dimensions.height+"px";
				let textwidth = element.el.clientWidth;
				let direction=(count)%2===0 ? -1.0 : 1.0;
				let startleft = (count)%2===0 ? e.dimensions.width : -1.0*textwidth;
				let endleft = (count)%2===0 ? -1.0*textwidth : e.dimensions.width;
				z.tools.logmsg("count = " + count + " endleft = " + endleft + " startleft = " + startleft);
				element.el.style[ "left" ] = startleft+"px";
				element.el.style[ "top" ] = -1.0*z.tools.randominteger(100,e.dimensions.height/2)+"px";
				element.el.style[ "opacity" ] = 0.4;

				Velocity({	
					elements: element.el,
					properties: { opacity:0.8, left: endleft, color: color },
					options: { duration: n*dt*600,  delay: 0, easing: "linear" },
				});
				Velocity({	
					elements: element.el,
					properties: { opacity:0.0 },
					options: { duration: n*dt*200,  delay: 0 },
				});
				// })
			} catch(err) { z.tools.logerror("word 1 animation ::: " + err ) }
		},
	]
	z.tools.logmsg("#word elements = " + elements.length);
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		drawings[Math.floor(e.clock.t/(dt*elements.length))%drawings.length](e);
	})
})(4);

//poems
( dt => {
	const afterclassnames1 = ["after0", "after1", "after2", "after3", "after4", "after5", "after6", "after7", "after8", "after9", "after10", "after11", "after12", "after13"];
	const afterclassnames2 = ["afterblackwhite", "afterwhiteblack"];
	const warmblacktints = ["#191918", "#2f2f2f", "#464646", "#5e5e5d", "#757574", "#8c8c8b", "#a3a3a2", "#babab9", "#d1d1d0", "#e8e8e7", "#ffffff", "#fcfbe3", "#e2e1cc", "#c9c8b5", "#b0af9e", "#979688", "#7e7d71", "#64645a", "#4b4b44", "#32322d", "#191916", "#000000"];

	const elements = ( () => {
		return Array.from(document.querySelectorAll(".poem")).reduce( (acc,el,j)=> {
			z.tools.logmsg("create poem element ::: " + j);
			acc[j]={ el:el, id:"poem"+j, stanzas: Array.from(el.querySelectorAll(".stanza")).reduce( (acc,el,j)=> {
				el.setAttribute("id", "stanza"+j);
				el.className= "stanza " + afterclassnames1[j%afterclassnames1.length] + " " + afterclassnames2[0];
				acc[j]={ el:el, lines:Array.from(el.querySelectorAll("li")).reduce( (acc,el,j)=> {
					acc[j]={ el:el };
					return acc;
					}, []) }; 
				return acc;
			}, []) };
			return acc;
		}, []);
	})();
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		try {
			let count = e.clock.t/dt;
			let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
			elements.forEach((poem,p) => {
				poem["stanzas"].forEach((stanza,s) => {
					if(count%2===0) {
						stanza.el.className= "stanza " + afterclassnames2[count/2%afterclassnames2.length] + " " + afterclassnames1[z.tools.randominteger(0,afterclassnames1.length)];
					}
					else {
						stanza["lines"].forEach( (line,l) => {
							line.el.style["color"] = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
						})
					}
				})
			});
		} catch(err) { z.tools.logerror("poem animation ::: " + err ) }
	})
})(18);



//circles 1
( dt => {
	const nelements=[[...Array(4).keys()],[...Array(4).keys()]][v];
	const elements = nelements.reduce( (acc, id) => {
		z.tools.logmsg("create line element ::: " + id);
		let el = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		el.setAttributeNS(null, "id", "circle1_"+ id);
		el.setAttributeNS(null, "class", "shape circle");
		el.setAttributeNS(null, "stroke-opacity", "0.0");
		el.setAttributeNS(null, "fill-opacity", "0.0");
		el.setAttributeNS(null, "cy", Math.floor(window.innerHeight/2));
		el.setAttributeNS(null, "cx", Math.floor(window.innerWidth/2));
		z.elements["svg"].el.appendChild(el);
		acc[id] = { el: el };
	return acc;
	}, []);
	// const cxs = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9];
	const cxs = [0.2,0.4,0.6,0.8];
	const cys = [0.2,0.4,0.6,0.8];
	const n = elements.length;
	const drawings = [
		e => {
			try {
				let count = e.clock.t/dt;
				let timing = timings[z.tools.randominteger(0,timings.length)];
				let duration = dt*timing[0]*n, delay = z.tools.randominteger(0, dt*timing[1]*n);
				let element = elements[count%n];
				let cy = z.tools.randominteger(0, e.dimensions.height);
				let cx = z.tools.randominteger(0, e.dimensions.width);
				let radius = z.tools.randominteger(14, e.dimensions.min);
				let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
				Velocity({	
					elements: element.el,
					properties: { fillOpacity: 1.0, strokeOpacity: 0.0, stroke: color, strokeWidth: z.tools.randominteger(e.dimensions.min/2, e.dimensions.min/6), strokeDasharray: z.tools.randominteger(8, e.dimensions.min), fill: color, cx: cx, cy: cy, r: radius },
					options: { duration: duration,  delay: delay },
				});
			} catch(err) { z.tools.logerror("circle animation 1 ::: " + err ) }
		},
		
	];
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		drawings[Math.floor(e.clock.t/(dt*elements.length))%drawings.length](e);
	})
})(5);

//circles 2
( dt => {
	const nelements=[[...Array(16).keys()],[...Array(32).keys()]][v];
	let width = window.innerWidth, height = window.innerHeight;
	const elements = nelements.reduce( (acc, id) => {
		z.tools.logmsg("create line element ::: " + id);
		let el = document.createElementNS("http://www.w3.org/2000/svg", "circle");
		el.setAttributeNS(null, "id", "circle2_"+ id);
		el.setAttributeNS(null, "class", "shape circle");
		el.setAttributeNS(null, "stroke-opacity", "0.0");
		el.setAttributeNS(null, "fill-opacity", "0.1");
		el.setAttributeNS(null, "cy", height/2);
		el.setAttributeNS(null, "cx", width/2);
		// el.setAttributeNS(null, "r", height/6);
		z.elements["svg"].el.appendChild(el);
		acc[id] = { el: el };
	return acc;
	}, []);
	// const cxs = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9];
	const cxs = [0.2,0.5,0.8];
	const cys = [0.2,0.5,0.8];
	const n = elements.length;
	const drawings = [
		e => {
			try {
				let count = e.clock.t/dt;
				let timing = timings[z.tools.randominteger(0,timings.length)];
				let duration = dt*timing[0], delay = z.tools.randominteger(0, dt*timing[1]);
				let element = elements[count%n];
				let cy = e.dimensions.height*cys[z.tools.randominteger(0,cys.length)];
				// let cx = e.dimensions.width*cxs[z.tools.randominteger(0,cxs.length)];
				let cx = e.dimensions.width*cxs[(count%n)%cxs.length];
				let radius = z.tools.randominteger(14, e.dimensions.min/2);
				let color = e.color.choices[z.tools.randominteger(0, e.color.choices.length)];
				Velocity({	
					elements: element.el,
					properties: { fillOpacity: 1.0, strokeOpacity: 0.0, stroke: color, strokeWidth: z.tools.randominteger(radius/2, radius/4), strokeDasharray: z.tools.randominteger(8, radius), fill: color, cx: cx, cy: cy, r: radius },
					options: { duration: duration*n/2,  delay: delay },
				});
				Velocity({	
					elements: element.el,
					properties: { r: radius/4 },
					options: { duration: duration*n/2,  delay: delay*n },
				});
			} catch(err) { z.tools.logerror("circle animation 1 ::: " + err ) }
		},
		
	];
	z.streams["draw"].filter(e => e.clock.t%dt===0).onValue( e => {
		drawings[Math.floor(e.clock.t/(dt*elements.length))%drawings.length](e);
	})
})(1);



const p = [
	e => {
		let cy = z.tools.randominteger(0,e.dimensions.height);
		return {
			xend: [-2.0*e.dimensions.width, z.tools.randominteger(-1.0*e.dimensions.width/4, -1.0*e.dimensions.width/2)],
			xstart: [z.tools.randominteger(e.dimensions.width*1.2, e.dimensions.width*1.4), 2*e.dimensions.width],
			ystart: [cy,cy], yend: [cy,cy]
		}
	},
	e => {
		let cx = z.tools.randominteger(0,e.dimensions.width);
		return {
			yend: [-2.0*e.dimensions.height, z.tools.randominteger(-1.0*e.dimensions.height/4, -1.0*e.dimensions.height/2)],
			ystart: [z.tools.randominteger(e.dimensions.height*1.2, e.dimensions.height*1.4), 2*e.dimensions.height],
			xstart: [cx,cx], xend: [cx,cx]
		}
	},
	e => {
		let cy = z.tools.randominteger(0,e.dimensions.height);
		return {
			xstart: [-2.0*e.dimensions.width, z.tools.randominteger(-1.0*e.dimensions.width/4, -1.0*e.dimensions.width/2)],
			xend: [z.tools.randominteger(e.dimensions.width*1.2, e.dimensions.width*1.4), 2*e.dimensions.width],
			ystart: [cy,cy], yend: [cy,cy]
		}
	},
	e => {
		let cx = z.tools.randominteger(0,e.dimensions.width);
		return {
			ystart: [-2.0*e.dimensions.height, z.tools.randominteger(-1.0*e.dimensions.height/4, -1.0*e.dimensions.height/2)],
			yend: [z.tools.randominteger(e.dimensions.height*1.2, e.dimensions.height*1.4), 2*e.dimensions.height],
			xstart: [cx,cx], xend: [cx,cx]
		}
	}
];


};

//test
window.addEventListener('load', e => {
  z.draw(z);
  window.scroll(0,0);
  // window.setTimeout(() => { document.querySelector("#contentframe").style.opacity = 1.0 }, 800);
});
window.addEventListener('beforeunload', e => {
	window.scroll(0,0);
});
</script>
</html>